@version:3.2
# syslog-ng configuration file.
#
# This should behave pretty much like the original syslog on RedHat. But
# it could be configured a lot smarter.
#
# See syslog-ng(8) and syslog-ng.conf(5) for more information.
#

options {
flush_lines (0);
time_reopen (10);
log_fifo_size (1000);
long_hostnames (off);
use_dns (no);
use_fqdn (no);
create_dirs (yes);
keep_hostname (yes);
flush_lines(0); perm(0655); stats_freq(3600);
frac_digits(3);
};

source s_sys {
file ("/proc/kmsg" program_override("kernel: "));
unix-stream ("/dev/log");
internal();
# udp(ip(0.0.0.0) port(514));
};

source net {
#udp();
tcp(ip("0.0.0.0") port(514));
#tcp();
#udp(ip("10.160.170.15") port(514));
udp(ip("0.0.0.0") port(514));
};

template template_hblab {
    template("${HOST}~${MSG}\n");
    template_escape(no);
        };


#TEST FORWARDING SYSLOG
destination d_syslog02_udp {syslog("10.160.170.16" transport("udp") port(514)); };
log { source(net);destination(d_syslog02_udp);};


destination d_cons { file("/dev/console"); };
destination d_mesg { file("/var/log/messages"); };
destination d_auth { file("/var/log/secure"); };
destination d_mail { file("/var/log/maillog" flush_lines(10)); };
destination d_spol { file("/var/log/spooler"); };
destination d_boot { file("/var/log/boot.log"); };
destination d_cron { file("/var/log/cron"); };
destination d_kern { file("/var/log/kern"); };
destination d_mlal { usertty("*"); };

filter f_kernel     { facility(kern); };
filter f_default    { level(info..emerg) and
		not (facility(mail)
		or facility(authpriv)
		or facility(cron)); };
filter f_auth       { facility(authpriv); };
filter f_mail       { facility(mail); };
filter f_emergency  { level(emerg); };
filter f_news       { facility(uucp) or
		(facility(news)
		and level(crit..emerg)); };
filter f_boot   { facility(local7); };
filter f_cron   { facility(cron); };

#log { source(s_sys); filter(f_kernel); destination(d_cons); };
log { source(s_sys); filter(f_kernel); destination(d_kern); };
log { source(s_sys); filter(f_default); destination(d_mesg); };
log { source(s_sys); filter(f_auth); destination(d_auth); };
log { source(s_sys); filter(f_mail); destination(d_mail); };
log { source(s_sys); filter(f_emergency); destination(d_mlal); };
log { source(s_sys); filter(f_news); destination(d_spol); };
log { source(s_sys); filter(f_boot); destination(d_boot); };
log { source(s_sys); filter(f_cron); destination(d_cron); };

# vim:ft=syslog-ng:ai:si:ts=4:sw=4:et:

##### 7750 DCGW #####
filter f_fs_nokia_oll      { netmask ("10.9.192.1/255.255.255.255") or netmask ("10.9.192.2/255.255.255.255"); };
destination d_fs_nokia_oll { file("/syslog/log/nokia/fs_nokia_oll.log" perm(0655)); }; #
log { source(net); filter(f_fs_nokia_oll); destination(d_fs_nokia_oll); flags(final); };


destination d_sdn_nokia { file("/syslog/log/sdn_nokia.log" perm(0655)); }; #
destination ims_nokia { file("/syslog/log/ims_nokia.log" perm(0655)); }; #
destination pcrf_labo { file("/syslog/log/pcrf_labo.log" perm(0655)); }; #
destination pcrf_jon { file("/syslog/log/pcrf_jon.log" perm(0655)); }; #
destination pcrf_cor { file("/syslog/log/pcrf_cor.log" perm(0655)); }; #
destination pcrf_prepro { file("/syslog/log/pcrf_prepro.log" perm(0655)); }; #
destination pcrf_vtor { file("/syslog/log/pcrf_vtor.log" perm(0655)); }; #
destination pcrf_vcor { file("/syslog/log/pcrf_vcor.log" perm(0655)); }; #
destination ipran { file("/syslog/log/ipran.log" perm(0655)); }; #
destination asr5k_cor { file("/syslog/log/asr5k_cor.log" perm(0655)); };
destination asr5k_ros { file("/syslog/log/asr5k_ros.log" perm(0655)); };
destination asr5k5-1_jo2 { file("/syslog/log/asr5k5-1_jon.log" perm(0655)); };
destination asr5k5-2_jo2 { file("/syslog/log/asr5k5-2_jon.log" perm(0655)); };
destination asr5k5-1_tor { file("/syslog/log/asr5k5-1_tor.log" perm(0655)); };
destination asr5k5-3_tor { file("/syslog/log/asr5k5-3_tor.log" perm(0655)); };
destination asr5k_asu { file("/syslog/log/asr5k_asu.log" perm(0655)); };
destination asr5k5_asu { file("/syslog/log/asr5k5_asu.log" perm(0655)); };
destination asr5k_mon { file("/syslog/log/asr5k_mon.log" perm(0655)); };
destination ng_tor1 { file("/syslog/log/ng_tor1.log" perm(0655)); };
destination ng_tor2 { file("/syslog/log/ng_tor2.log" perm(0655)); };
destination ng_jon2 { file("/syslog/log/ng_j0n2.log" perm(0655)); };
destination asr5k5_tor { file("/syslog/log/asr5k5_tor.log" perm(0655)); };
destination asr5k5_ros { file("/syslog/log/asr5k5_ros.log" perm(0655)); };
destination asr5k_mon { file("/syslog/log/asr5k_mon.log" perm(0655)); };
destination asr5k5-2_cor { file("/syslog/log/asr5k5-2_cor.log" perm(0655)); };
destination d_tor-vpc-1 { file("/syslog/log/tor-vpc-1.log" perm(0655)); };
destination d_cor-vpc-1 { file("/syslog/log/cor-vpc-1.log" perm(0655)); };


destination vecta { file("/syslog/log/vecta_lmds.log" perm(0655)); };
destination sbc { file("/syslog/log/sbc.log" perm(0655)); };




destination wimaxe { file("/syslog/log/wimaxe.log" perm(0655)); };
#destination debug { file("/syslog/log/debug.log" perm(0655)); };
destination speedtest { file("/syslog/log/speedtest.log" perm(0655)); };
destination conmutacion { file("/syslog/log/conmutacion.log" perm(0655)); };
destination softswitch { file("/syslog/log/softswitch.log" perm(0655)); };
destination accounting { file("/syslog/dcn-fw/accounting.log" perm(0655)); };
destination cableras { file("/syslog/log/cableras.log" perm(0655)); };
destination backbone { file("/syslog/log/backbone.log" perm(0655)); };
destination backboneH { file("/syslog/log/backboneH.log" perm(0655)); };
destination giant { file("/syslog/log/giant.log" perm(0655)); };
destination backbone-clientes { file("/syslog/log/backbone-clientes.log" perm(0655)); };
destination cpe-metroethernet { file("/syslog/log/metroethernet-cpe.log" perm(0655)); };
destination elk-rever {syslog("172.16.254.227" transport("udp") port(5141) ); };
destination elk-rever2 {syslog("172.16.254.227" transport("udp") port(5142) ); };
destination elk-rever3 {syslog("172.16.254.227" transport("udp") port(5143) ); };

destination cpe-mpls { file("/syslog/log/mpls-cpe.log" perm(0655)); };
destination plataforma { file("/syslog/log/plataforma.log" perm(0655)); };
destination dialvoice { file("/syslog/log/dialvoice.log" perm(0655)); };
destination iad { file("/syslog/iad/iad.log" perm(0655)); };
#destination iad { };
destination dcn-firewall { file("/syslog/dcn-fw/firewall.log" perm(0655)); };
destination dcn { file("/syslog/log/dcn.log" perm(0655)); };
destination cpe-clientes { file("/syslog/log/clientes.log" perm(0655)); };

destination dhcp { file("/syslog/log/dhcp.log" perm(0655)); };
# destination monitoreo { file("/syslog/log/monitoreo.log" perm(0655)); };
destination syslog_regional { udp("201.139.160.25"); };
destination dns-sudo { file("/syslog/dcn-fw/dns-sudo.log" perm(0655)); };
destination wine-sudo { file("/syslog/dcn-fw/wine-sudo.log" perm(0655)); };
destination tftp-dhcp_spa { file("/syslog/log/tftp-dhcp_spa.log" perm(0655)); };
destination ertach_all { file("/syslog/log/ertach.log" perm(0655)); };
destination tech_acceso { file("/syslog/log/tech_acceso.log" perm(0655)); };
destination incognito { file("/syslog/log/incognito.log" perm(0655)); };
destination arbor { file("/syslog/log/arbor.log" perm(0655)); };

#VMWARE SHADOW
destination vcentershadow { file("/syslog/log/vcentershadow.log" perm(0655)); };
#FREENAS STORAGES SHADOW
destination d_freenas { file("/syslog/log/freenas.log" perm(0655)); };



filter f_pcrf_labo       { netmask ("172.16.254.25/255.255.255.255") or netmask ("172.16.254.23/255.255.255.255") or netmask ("172.16.254.25/255.255.255.255") or netmask ("172.16.254.27/255.255.255.255") or netmask ("10.84.105.58/255.255.255.255"); or netmask ("10.84.105.84/255.255.255.255") or netmask ("10.84.105.83/255.255.255.255") or netmask ("10.84.105.70/255.255.255.255") or netmask ("10.84.105.71/255.255.255.255") or netmask ("10.84.105.86/255.255.255.255") or netmask ("10.84.105.87/255.255.255.255"); };
filter f_pcrf_prepro       { netmask ("172.16.254.55/255.255.255.255"); };
filter f_pcrf_jon       { netmask ("10.92.59.0/255.255.255.0") or netmask ("10.112.91.0/26") or netmask ("10.112.90.0/26"); };
filter f_pcrf_cor       { netmask ("10.48.34.0/255.255.255.0") or netmask ("10.112.91.64/26") or netmask ("10.112.90.64/26"); };
filter f_ipran       { netmask ("10.2.1.0/255.255.255.0") or  netmask ("10.2.20.0/255.255.255.0") or netmask ("10.2.21.0/255.255.255.0") or netmask ("10.2.22.0/255.255.255.0") or netmask ("10.2.23.0/255.255.255.0") or netmask ("10.2.46.0/255.255.255.0") or netmask ("10.2.48.0/255.255.255.0") or netmask ("10.2.49.0/255.255.255.0") or netmask ("10.2.50.0/255.255.255.0") or netmask ("10.2.51.0/255.255.255.0") or netmask ("10.2.52.0/255.255.255.0") or netmask ("10.2.53.0/255.255.255.0") or netmask ("10.2.54.0/255.255.255.0") or netmask ("10.2.55.0/255.255.255.0") or netmask ("10.2.56.0/255.255.255.0") or netmask ("10.2.57.0/255.255.255.0") or netmask ("10.2.58.0/255.255.255.0") or netmask ("10.2.59.0/255.255.255.0") or netmask ("10.2.60.0/255.255.255.0") or netmask ("10.2.72.0/255.255.255.0") or netmask ("10.2.93.0/255.255.255.0") or netmask ("10.2.94.0/255.255.255.0") or netmask ("10.2.95.0/255.255.255.0") or netmask ("10.2.97.0/255.255.255.0") or netmask ("10.2.101.0/255.255.255.0") or netmask ("10.2.102.0/255.255.255.0") or netmask ("10.2.110.0/255.255.255.0") or netmask ("10.2.215.0/255.255.255.0");};
filter f_pcrf_vcor       { netmask ("10.48.35.224/255.255.255.224") or netmask ("10.112.92.160/255.255.255.224") or netmask ("10.112.92.192/255.255.255.224"); };
filter f_pcrf_vtor       { netmask ("10.48.35.192/255.255.255.224") or netmask ("10.112.91.0/255.255.255.224") or netmask ("10.112.92.128/255.255.255.224"); };

#VMWARE SHADOW
filter f_vcentershadow      { netmask ("172.16.254.0/255.255.255.0") or netmask ("10.104.127.0/255.255.255.0"); };

filter f_asr5k5-1_jo2       { netmask ("10.92.111.4/255.255.255.255"); };
filter f_asr5k5-2_jo2       { netmask ("192.168.72.116/255.255.255.255"); };
filter f_asr5k5-1_tor       { netmask ("10.105.148.4/255.255.255.255"); };
filter f_asr5k5-3_tor       { netmask ("10.106.4.52/255.255.255.255"); };
filter f_asr5k_cor       { netmask ("10.104.133.116/255.255.255.255"); };
filter f_asr5k_ros       { netmask ("10.76.22.210/255.255.255.255"); };
filter f_asr5k_asu       { netmask ("192.168.45.108/255.255.255.255"); };
filter f_asr5k5_asu       { netmask ("192.168.45.140/255.255.255.255"); };
filter f_asr5k_mon       { netmask ("192.168.45.12/255.255.255.255"); };
filter f_ng_tor1      { netmask ("192.168.12.250/255.255.255.255"); };
filter f_ng_tor2      { netmask ("192.168.12.210/255.255.255.255"); };
filter f_ng_jon2      { netmask ("10.104.237.17/255.255.255.255"); };
filter f_asr5k5_tor       { netmask ("192.168.29.156/255.255.255.255"); };
filter f_asr5k5_ros       { netmask ("192.168.29.148/255.255.255.255"); };
filter f_asr5k5-2_cor       { netmask ("192.168.72.124/255.255.255.255"); };
filter f_tor-vpc-1       { netmask ("10.84.105.250/255.255.255.255"); };
#filter f_cor-vpc-1       { host ("10.48.132.139"); };
filter f_cor-vpc-1       { netmask ("10.48.132.139/255.255.255.255"); };


filter f_arbor       { netmask ("10.2.182.0/255.255.255.0"); };

filter f_vecta       { netmask ("10.186.0.0/255.255.255.0") ; };
#filter f_vecta       { netmask ("10.160.158.130/255.255.255.255")  or netmask ("10.160.158.146/255.255.255.255") ; };
filter f_sbc       { netmask ("10.192.1.4/255.255.255.255") or netmask ("10.192.1.5/255.255.255.255") or netmask ("10.192.1.8/255.255.255.255") or netmask ("10.192.1.9/255.255.255.255") or netmask ("10.192.1.66/255.255.255.255") or netmask ("10.192.1.67/255.255.255.255") or netmask ("10.192.1.76/255.255.255.255")  or netmask ("10.192.1.77/255.255.255.255") ; };

filter f_ims_nokia	{ netmask ("10.111.19.35/255.255.255.255") or netmask ("10.111.48.50/255.255.255.255") or netmask ("10.111.33.12/255.255.255.255") or netmask ("10.111.33.52/255.255.255.255") or netmask ("10.111.33.32/255.255.255.255") or netmask ("10.111.19.14/255.255.255.255") or netmask ("10.111.19.25/255.255.255.255") or netmask ("10.111.48.10/255.255.255.255"); };

filter f_wimaxe       { netmask ("10.186.0.0/255.255.0.0") ; };
filter f_ertach_all     { netmask("10.40.0.0/255.255.0.0") or netmask ("10.50.0.0/255.255.0.0") or netmask ("10.51.0.0/255.255.0.0") or netmask ("10.55.0.0/255.255.0.0"
) or netmask ("10.56.0.0/255.255.0.0") or netmask ("10.63.0.0/255.255.0.0") or netmask ("222.0.0.0/255.0.0.0"); };

filter f_cableras       { netmask ("10.197.248.0/255.255.255.0"); };
#filter f_debug          { not host(".*.cx.ar.telmex") and level(debug); };
filter f_backbone-clientes { facility(local0) and message (" %BGP(-.*){2}: .* ((154\.0\|201\.118).[0-9]{1,3}|187\.128\.2)\.[0-9]{1,3} "); }; #MATCH

filter f_backbone       { netmask ("200.80.173.0/255.255.255.0") or netmask ("200.80.160.0/255.255.255.0") or netmask ("200.69.129.0/255.255.255.0") or netmask ("222.50.0.0/255.255.0.0") or netmask ("222.51.0.0/255.255.0.0") or netmask ("10.40.0.0/255.255.0.0") or netmask ("10.197.248.0/255.255.255.0") or netmask ("154.0.10.74/255.255.255.255") or netmask ("154.0.10.78/255.255.255.255") or netmask ("200.59.129.0/255.255.255.0") or netmask ("10.1.0.0/255.255.255.0") or netmask ("10.2.196.0/255.255.255.0") or netmask ("10.2.188.0/255.255.255.0") or netmask ("10.2.189.0/255.255.255.0"); };
filter f_backboneH       { netmask ("10.2.191.0/255.255.255.0") ; };

#filter f_backbone       { facility(local0) and not filter(f_cableras) and not filter(f_backbone-clientes) and not filter(f_tech_acceso); };
filter f_incognito      { netmask ("10.160.142.71/255.255.255.255") or netmask ("10.160.142.72/255.255.255.255") ; };
filter f_cpe-metroeth   { facility(local1) and not filter(f_tech_acceso); };
filter f_cpe-mpls       { facility(local2); };
filter f_plataforma     { facility(local3); };
filter f_dialvoice      { facility(local4); };
# filter f_monitoreo    { facility(local5); };
filter f_conmutacion    { facility(local5); };
filter f_softswitch     { not filter(f_conmutacion) and host(".cx.ar.telmex$"); };
filter f_accounting     { facility(auth); };
#filter f_dcn-fw         { facility(local0) and message("NetScreen"); };
#filter f_dcn-fw         { facility(local6); };
filter f_dcn-fw         { netmask ("10.160.23.1/255.255.255.255") or netmask ("10.160.23.2/255.255.255.255"); };
filter f_dcn            { facility(local6) and not message("NetScreen") and not message("%PIX"); }; #MATCH
filter f_cpe-clientes   { facility(local7) and not filter(f_apic_oll) and not filter(f_apic_cor); };


# filter f_dhcp           { host("^192\.168\.220\.121$") or host("^dhcp01\.oss\.ar\.telmex$"); };
destination d_hblab {syslog("10.104.127.80" transport("udp") port(5144)); };
log { source(net);  filter(f_dhcp); destination(d_hblab); };
filter f_dhcp           { program("dhcpd"); };
filter f_speedtest           { program("speedtest"); };
filter f_iad            { netmask("10.194.0.0/255.255.0.0") or netmask("10.195.0.0/255.255.0.0") or netmask("10.196.0.0/255.255.0.0"); };
# Temporal el renglon de abajo - preguntar a Larra para borrar 190.221.126.128/25 despues del 1/7/2011 - Pablo Carboni
#filter f_iad           { netmask("190.220.213.128/255.255.255.128") or netmask("190.221.126.128/255.255.255.128") or netmask("10.194.0.0/255.255.0.0") or netmask("10.195.0.0/255.255.0.0") or netmask("10.196.0.0/255.255.0.0"); };
filter f_pe-mpls        { host(".pe-mpls\..*\.telmex$"); };
filter f_dns-sudo       { facility(local2) and program("sudo") and (netmask("10.160.143.2/255.255.255.255") or netmask("10.160.142.2/255.255.255.255") or netmask("10.160.142.5/255.255.255.255") or netmask("10.160.142.6/255.255.255.255") or netmask("10.160.143.5/255.255.255.255")); };

# Descomentar lo de abajo una vez que funcionen definitivamente las ips de dnses enumerados.
#filter f_dns-sudo      { facility(local2) and program("sudo") and (netmask("10.160.142.5/255.255.255.255") or netmask("10.160.143.5/255.255.255.255")); };
filter f_wine-sudo      { facility(local2) and program("sudo") and netmask("172.16.254.140/255.255.255.255"); };
filter f_tftp-dhcp_spa  { program("tftpd"); };
#and (netmask("10.160.143.3/255.255.255.255") or netmask("10.160.142.3/255.255.255.255")); };

filter f_tech_acceso    { netmask ("190.220.178.0/255.255.255.0") or netmask ("200.69.155.0/255.255.255.0") or netmask ("190.220.190.0/255.255.255.240") or message ("GP0"); }; #MATCH

#filter f_tech_acceso    { netmask ("200.69.155.0/255.255.255.128") or netmask ("190.220.190.0/255.255.255.240"); };

#filter f_freenas    { host ("172.16.254.51/255.255.255.255") or host ("10.185.254.14/255.255.255.255"); };
filter f_freenas    { host ("172.16.254.51") or host ("10.185.254.14") or host ("172.16.254.243") or host ("10.111.249.110") or host ("10.111.249.111") or host ("10.111.249.112"); };

filter f_sdn_nokia       { host ("10.92.105.107") or host("10.92.105.105"); };


###########CAC############
destination cac { file("/syslog/log/cac.log" perm(0655)); };
filter f_cac   { netmask ("10.2.212.0/255.255.255.0"); };
log { source(net); filter(f_cac); destination(cac); };
log { source(net); filter(f_cac); destination(elk-rever2); };
###########CAC############

destination d_hb01_sraf {syslog("10.104.127.80" transport("udp") port(5146) template(template_hblab)); };
log { source(net);  filter(f_tech_acceso); destination(d_hb01_sraf); };


#### Diego ####
destination d_gry-vpc-1 { file("/syslog/log/gry-vpc-1.log" perm(0655)); };
filter f_gry-vpc-1 { netmask ("10.92.105.31/255.255.255.255"); };
log { source(net); filter(f_gry-vpc-1); destination(d_gry-vpc-1); flags(final); };

destination d_oll-vpc-1 { file("/syslog/log/oll-vpc-1.log" perm(0655)); };
filter f_oll-vpc-1 { netmask ("10.4.24.19/255.255.255.255"); };
log { source(net); filter(f_oll-vpc-1); destination(d_oll-vpc-1); flags(final); };


#### Yaneht #######

destination d_slb01-02 { file("/syslog/log/slb-01-02.log" perm(0655)); };
filter f_slb01-02 { netmask ("10.92.15.26/255.255.255.255") or netmask ("10.92.15.27/255.255.255.255"); };
log { source(net); filter(f_slb01-02); destination(d_slb01-02); flags(final); };

destination d_TC2470-vASBC01-02 { file("/syslog/log/TC2470-vASBC01-02.log" perm(0655)); };
filter f_TC2470-vASBC01-02 { netmask ("10.84.121.170/255.255.255.255") or netmask ("10.84.121.171/255.255.255.255"); };
log { source(net); filter(f_TC2470-vASBC01-02); destination(d_TC2470-vASBC01-02); flags(final); };

destination d_CO008-vASBC01-02 { file("/syslog/log/CO008TC2470-vASBC01-02.log" perm(0655)); };
filter f_CO008-vASBC01-02 { netmask ("10.48.30.154/255.255.255.255") or netmask ("10.48.30.155/255.255.255.255"); };
log { source(net); filter(f_CO008-vASBC01-02); destination(d_CO008-vASBC01-02); flags(final); };

#destination d_vSBCTOR01-04 { file("/syslog/log/vSBCTOR01-04.log" perm(0655)); };
#filter f_vSBCTOR01-04 { netmask ("10.92.61.136/255.255.255.255") or netmask ("10.92.61.140/255.255.255.255") or netmask ("10.92.61.151/255.255.255.255") or netmask ("10.92.61.153/255.255.255.255"); };
#log { source(net); filter(f_vSBCTOR01-04); destination(d_vSBCTOR01-04); flags(final); };

destination d_vSRITX01-02 { file("/syslog/log/vSRITX01-02.log" perm(0655)); };
filter f_vSRITX01-02 { netmask ("10.84.121.181/255.255.255.240") or netmask ("10.91.61.187/255.255.255.255"); };
log { source(net); filter(f_vSRITX01-02); destination(d_vSRITX01-02); flags(final); };


##############################################
# Logging de Telmex
##############################################
log { source(net); filter(f_pcrf_prepro); destination(pcrf_prepro); flags(final); };
log { source(net); filter(f_pcrf_labo); destination(pcrf_labo); flags(final); };
log { source(net); filter(f_pcrf_jon); destination(pcrf_jon); flags(final); };
log { source(net); filter(f_pcrf_cor); destination(pcrf_cor); flags(final); };
log { source(net); filter(f_pcrf_vtor); destination(pcrf_vtor); flags(final); };
log { source(net); filter(f_pcrf_vcor); destination(pcrf_vcor); flags(final); };
log { source(net); filter(f_ipran); destination(ipran); flags(final); };
log { source(net); filter(f_asr5k5-1_jo2); destination(asr5k5-1_jo2); flags(final); };
log { source(net); filter(f_asr5k5-2_jo2); destination(asr5k5-2_jo2); flags(final); };
log { source(net); filter(f_asr5k5-1_tor); destination(asr5k5-1_tor); flags(final); };
log { source(net); filter(f_asr5k5-3_tor); destination(asr5k5-3_tor); flags(final); };
log { source(net); filter(f_asr5k_cor); destination(asr5k_cor); flags(final); };
log { source(net); filter(f_asr5k_ros); destination(asr5k_ros); flags(final); };
log { source(net); filter(f_asr5k_asu); destination(asr5k_asu); flags(final); };
log { source(net); filter(f_asr5k5_asu); destination(asr5k5_asu); flags(final); };
log { source(net); filter(f_asr5k_mon); destination(asr5k_mon); flags(final); };
log { source(net); filter(f_ng_tor1); destination(ng_tor1); flags(final); };
log { source(net); filter(f_ng_tor2); destination(ng_tor2); flags(final); };
log { source(net); filter(f_ng_jon2); destination(ng_jon2); flags(final); };
log { source(net); filter(f_asr5k5_tor); destination(asr5k5_tor); flags(final); };
log { source(net); filter(f_asr5k5_ros); destination(asr5k5_ros); flags(final); };
log { source(net); filter(f_arbor); destination(arbor); flags(final); };
log { source(net); filter(f_asr5k5-2_cor); destination(asr5k5-2_cor); flags(final); };
log { source(net); filter(f_tor-vpc-1); destination(d_tor-vpc-1); flags(final); };
log { source(net); filter(f_cor-vpc-1); destination(d_cor-vpc-1); flags(final); };



log { source(net); filter(f_vecta); destination(vecta); flags(final); };



log { source(net); filter(f_sbc); destination(sbc);  };

log { source(net); filter(f_wimaxe); destination(wimaxe); flags(final); };

log { source(net); filter(f_speedtest); destination(speedtest); flags(final); };
#log { source(net); filter(f_speedtest); destination(d_mysql2); };

log { source(net); filter(f_dhcp); destination(dhcp); flags(final); };
#log { source(net); filter(f_dhcp); destination(d_mysql2); };

log { source(net); filter(f_iad); destination(iad);  };

log { source(net); filter(f_dns-sudo); destination(dns-sudo); };
log { source(net); filter(f_wine-sudo); destination(wine-sudo); };
log { source(net); filter(f_tftp-dhcp_spa); destination(tftp-dhcp_spa); };
log { source(net); filter(f_ertach_all); destination(ertach_all); flags(final); };

#log { source(net); filter(f_debug); destination(debug); flags(final); };
#log { source(net); filter(f_debug); destination(d_mysql2); };

log { source(net); filter(f_conmutacion); destination(conmutacion); };
log { source(net); filter(f_softswitch); destination(softswitch); flags(final); };

log { source(net); filter(f_accounting); destination(accounting); };
#log { source(net); filter(f_accounting); destination(d_mysql2); };

log { source(net); filter(f_cableras); destination(cableras); };
#log { source(net); filter(f_cableras); destination(d_mysql2); };

log { source(net); filter(f_backbone); destination(backbone); };
log { source(net); filter(f_backboneH); destination(backboneH); };
#log { source(net); filter(f_backbone); destination(d_mysql2); };

log { source(net); filter(f_incognito); destination(incognito); };
#log { source(net); filter(f_incognito); destination(d_mysql2); };
log { source(net); filter(f_backbone-clientes); destination(backbone-clientes); };

log { source(net); filter(f_cpe-metroeth); destination(elk-rever); };
log { source(net); filter(f_cpe-metroeth); destination(cpe-metroethernet); };

log { source(net); filter(f_cpe-mpls); destination(cpe-mpls); };
log { source(net); filter(f_cpe-mpls); destination(elk-rever3); };

log { source(net); filter(f_plataforma); destination(plataforma); };
log { source(net); filter(f_dialvoice); destination(dialvoice); };
log { source(net); filter(f_dcn-fw); destination(dcn-firewall); };
log { source(net); filter(f_dcn); destination(dcn); };
log { source(net); filter(f_cpe-clientes); destination(cpe-clientes); };

#log { source(net); filter(f_cac); destination(cac); };

log { source(net); filter(f_pe-mpls); destination(syslog_regional); };
log { source(net); filter(f_tech_acceso); destination(tech_acceso); flags(final); };

log { source(net); filter(f_ims_nokia); destination(ims_nokia); flags(final); };


log { source(net); filter(f_vcentershadow); destination(vcentershadow); flags(final); };


log { source(net); filter(f_freenas); destination(d_freenas); flags(final); };


log { source(net); filter(f_sdn_nokia); destination(d_sdn_nokia); flags(final); };




############## TEMPLATE CORPO ################

rewrite r_cisco {
 set("$1", value("PROGRAM") condition(filter(f_rewrite_cisco_program)));
 set("$2", value("MESSAGE") condition(filter(f_rewrite_cisco_program)));
};

template template_hblab {
    template("${HOST}~${MSG}\n");
    template_escape(no);
        };


destination d_hb01 {syslog("10.104.127.80" transport("udp") port(5141) template(template_hblab)); };
log { source(net);  filter(f_backbone); destination(d_hb01); };

template template_corpo {
    template("${YEAR}-${MONTH}-${DAY}~${HOUR}:${MIN}:${SEC}~${HOST}~${MSG}\n");
    template_escape(no);
        };

filter f_rewrite_cisco_program {
  match('%([^:]+):\s+([^\n]+)' value("MESSAGE") type("pcre")
flags("store-matches" "nobackref"));
};

rewrite r_cisco_program {
 set("$1", value("PROGRAM") condition(filter(f_rewrite_cisco_program)));
 set("$1~$2", value("MESSAGE") condition(filter(f_rewrite_cisco_program)));
};

destination d_corpo {file("/syslog/log/corpo.log" perm(0655) template(template_corpo)); };
log { source(net); filter(f_backbone); rewrite(r_cisco_program); destination(d_corpo);  };

#TEST FORWARDING SYSLOG
destination d_syslog_udp {syslog("10.92.97.204" transport("udp") port(5140)); };
log { source(net);destination(d_syslog_udp);};



####################################################################################

filter f_pgw-affirmed    { netmask ("10.84.105.170/255.255.255.255") or netmask ("10.84.105.171/255.255.255.255") or netmask ("10.84.105.172/255.255.255.255"); };
destination d_pgw-affirmed { file("/syslog/log/pgw-affirmed.log" perm(0655)); };
log { source(net); filter(f_pgw-affirmed); destination(d_pgw-affirmed); };


filter f_sparc_zones    { host ("172.16.254.235") or host ("172.16.254.236") or host ("172.16.254.237") or host ("172.16.254.238")  or host ("10.160.170.80") or host ("10.160.170.81") or host ("10.160.170.82") or host ("10.160.170.83"); };
destination d_sparc_zones { file("/syslog/log/sparc_zones.log" perm(0655)); };
log { source(net); filter(f_sparc_zones); destination(d_sparc_zones); };

filter f_cmic_openstack		{ netmask ("10.48.161.0/255.255.255.0"); };
destination d_cmic_openstack { file("/syslog/log/cmic_openstack_tor.log" perm(0655)); };
log { source(net); filter(f_cmic_openstack); destination(d_cmic_openstack); };

filter f_sdwan_tor         { netmask ("10.92.176.0/255.255.255.192"); };
destination d_sdwan_tor { file("/syslog/log/sdwan_tor" perm(0655)); };
log { source(net); filter(f_sdwan_tor); destination(d_sdwan_tor); };

filter f_paloalto         { netmask ("10.84.105.225/255.255.255.255") or netmask ("10.105.125.8/255.255.255.255") ; };
destination d_paloalto { file("/syslog/log/paloalto" perm(0655)); };
log { source(net); filter(f_paloalto); destination(d_paloalto); };

#filter f_gm-paloalto         { host ("10.84.105.225"); };
#filter f_gm-paloalto           { program("PA-VM"); };
#destination d_gm-paloalto { file("/syslog/log/gm-paloalto" perm(0655)); };
#log { source(net); filter(f_gm-paloalto); destination(d_gm-paloalto); };

filter f_nxfi        { host ("10.48.13.4") or host ("10.48.13.5") or host ("10.84.82.132") or host ("10.84.82.133"); };
destination d_nxfi { file("/syslog/log/nxfi" perm(0655)); };
log { source(net); filter(f_nxfi); destination(d_nxfi); };

filter f_purestorage        { netmask ("192.168.111.40/255.255.255.248") or netmask ("192.168.111.56/255.255.255.248"); };
destination d_purestorage { file("/syslog/log/purestorage" perm(0655)); };
log { source(net); filter(f_purestorage); destination(d_purestorage); };

filter f_ucs_esxi    { netmask ("10.84.106.192/255.255.255.224") or netmask ("10.84.89.0/255.255.255.128") or netmask ("10.92.106.0/255.255.255.0") or netmask ("10.106.11.0/255.255.255.0")  or netmask ("10.104.32.0/255.255.255.0") or netmask ("10.84.105.0/255.255.255.0") or netmask ("10.49.100.0/255.255.255.0") or netmask ("10.49.101.0/255.255.255.0"); };
destination d_ucs_esxi { file("/syslog/log/ucs_esxi.log" perm(0655)); };
log { source(net); filter(f_ucs_esxi); destination(d_ucs_esxi); flags(final); };

filter f_vcenter_tor     { host ("10.84.82.94"); };
destination d_vcenter_tor { file("/syslog/log/vcenter_tor.log" perm(0655)); };
log { source(net); filter(f_vcenter_tor); destination(d_vcenter_tor); };

filter f_vcenter_gry     { host ("10.92.105.7"); };
destination d_vcenter_gry { file("/syslog/log/vcenter_gry.log" perm(0655)); };
log { source(net); filter(f_vcenter_gry); destination(d_vcenter_gry); };

filter f_vcenter_cor     { host ("10.48.13.126"); };
destination d_vcenter_cor { file("/syslog/log/vcenter_cor.log" perm(0655)); };
log { source(net); filter(f_vcenter_cor); destination(d_vcenter_cor); };

filter f_vcenteraci     { host ("10.92.198.250"); };
destination d_vcenteraci { file("/syslog/log/vcenteraci.log" perm(0655)); };
log { source(net); filter(f_vcenteraci); destination(d_vcenteraci); };

filter f_vcenteraci-idrac     { netmask ("10.93.2.0/255.255.255.0"); };
destination d_vcenteraci_idrac { file("/syslog/log/vcenteraci_idrac.log" perm(0655)); };
log { source(net); filter(f_vcenteraci-idrac); destination(d_vcenteraci_idrac); };



filter f_pcrf_voll       { netmask ("10.92.121.0/255.255.255.0"); };
destination pcrf_voll { file("/syslog/log/pcrf_voll.log" perm(0655)); }; #
log { source(net); filter(f_pcrf_voll); destination(pcrf_voll); flags(final); };

filter f_pcrf_vcor2       { netmask ("10.48.105.0/255.255.255.0"); };
destination pcrf_vcor2 { file("/syslog/log/pcrf_vcor2.log" perm(0655)); }; #
log { source(net); filter(f_pcrf_vcor2); destination(pcrf_vcor2); flags(final); };


filter f_ilom_pic       { netmask ("10.104.96.50/255.255.255.255") or netmask ("10.104.96.51/255.255.255.255") or netmask ("10.104.96.53/255.255.255.255"); };
destination d_ilom_pic { file("/syslog/log/ilom_pic.log" perm(0655)); }; #
log { source(net); filter(f_ilom_pic); destination(d_ilom_pic); flags(final); };

###### 7750 DCGW #####
#filter f_fs_nokia_oll      { netmask ("10.9.192.1/255.255.255.255") or netmask ("10.9.192.2/255.255.255.255"); };
#destination d_fs_nokia_oll { file("/syslog/log/nokia/fs_nokia_oll.log" perm(0655)); }; #
#log { source(net); filter(f_fs_nokia_oll); destination(d_fs_nokia_oll); flags(final); };

##### IDRAC VIAVI  #####
filter f_idrac_nitro       { netmask ("10.104.105.69/255.255.255.255") or netmask ("10.84.39.133/255.255.255.255") or netmask ("10.84.39.135/255.255.255.255") or netmask ("10.84.39.137/255.255.255.255") or netmask ("10.105.4.5/255.255.255.255") or netmask ("10.48.115.133/255.255.255.255") or netmask ("10.48.115.139/255.255.255.255") or netmask ("10.48.30.181/255.255.255.255") or netmask ("10.106.17.45/255.255.255.255") or netmask ("10.106.17.47/255.255.255.255") or netmask ("10.84.39.165/255.255.255.255") or netmask ("10.84.39.167/255.255.255.255") or netmask ("10.84.39.169/255.255.255.255") or netmask ("10.84.39.173/255.255.255.255") or netmask ("10.111.10.5/255.255.255.255") or netmask ("10.101.12.229/255.255.255.255") or netmask ("10.101.12.231/255.255.255.255"); };
destination d_idrac_nitro { file("/syslog/log/idrac_nitro.log" perm(0655)); }; #
log { source(net); filter(f_idrac_nitro); destination(d_idrac_nitro); flags(final); };


filter f_aws_elemental_oll      { netmask ("10.92.19.0/255.255.255.0"); };
destination d_aws_elemental_oll { file("/syslog/log/aws_elemental_oll.log" perm(0655)); }; #
log { source(net); filter(f_aws_elemental_oll); destination(d_aws_elemental_oll); flags(final); };

filter f_apic_oll        { netmask ("10.4.20.0/255.255.255.0"); };
destination d_apic_oll { file("/syslog/log/apic_oll.log" perm(0655)); };
log { source(net); filter(f_apic_oll); destination(d_apic_oll); };

filter f_apic_cor        { netmask ("10.4.22.0/255.255.255.0"); };
destination d_apic_cor { file("/syslog/log/apic_cor.log" perm(0655)); };
log { source(net); filter(f_apic_cor); destination(d_apic_cor); };


##### TELCO CLOUD #####

filter f_telcocloud_wbx_oll        { netmask ("10.92.208.6/255.255.255.255") or netmask ("10.92.208.7/255.255.255.255") or netmask ("10.92.208.11/255.255.255.255") or netmask ("10.92.208.12/255.255.255.255") or netmask ("10.92.208.16/255.255.255.255") or netmask ("10.92.208.17/255.255.255.255")  or netmask ("10.92.208.21/255.255.255.255") or netmask ("10.92.208.22/255.255.255.255") or netmask ("10.92.208.26/255.255.255.255") or netmask ("10.92.208.27/255.255.255.255") or netmask ("10.92.208.31/255.255.255.255") or netmask ("10.92.208.32/255.255.255.255") or netmask ("10.92.208.36/255.255.255.255") or netmask ("10.92.208.37/255.255.255.255") or netmask ("10.92.208.44/255.255.255.255") or netmask ("10.92.208.40/255.255.255.255") or netmask ("10.92.208.46/255.255.255.255") or netmask ("10.92.208.47/255.255.255.255") or netmask ("10.92.208.51/255.255.255.255") or netmask ("10.92.208.52/255.255.255.255") or netmask ("10.92.208.56/255.255.255.255") or netmask ("10.92.208.57/255.255.255.255"); };
destination d_telcocloud_wbx_oll { file("/syslog/telcocloud/wbx_oll.log" perm(0655)); };
log { source(net); filter(f_telcocloud_wbx_oll); destination(d_telcocloud_wbx_oll); };

filter f_telcocloud_mgmtsw_oll        { netmask ("10.92.208.10/255.255.255.255") or netmask ("10.92.208.15/255.255.255.255") or netmask ("10.92.208.20/255.255.255.255") or netmask ("10.92.208.25/255.255.255.255") or netmask ("10.92.208.30/255.255.255.255") or netmask ("10.92.208.35/255.255.255.255")  or netmask ("10.92.208.43/255.255.255.255") or netmask ("10.92.208.45/255.255.255.255") or netmask ("10.92.208.50/255.255.255.255") or netmask ("10.92.208.55/255.255.255.255"); };
destination d_telcocloud_mgmtsw_oll { file("/syslog/telcocloud/mgmtsw_oll.log" perm(0655)); };
log { source(net); filter(f_telcocloud_mgmtsw_oll); destination(d_telcocloud_mgmtsw_oll); };


filter f_telcocloud_nadcm_oll        { netmask ("10.92.208.60/255.255.255.255"); };
destination d_telcocloud_nadcm_oll { file("/syslog/telcocloud/nadcm_oll.log" perm(0655)); };
log { source(net); filter(f_telcocloud_nadcm_oll); destination(d_telcocloud_nadcm_oll); };

#10.92.202.123
filter f_telcocloud_arc_oll        { netmask ("10.92.202.122/255.255.255.255") or netmask ("10.92.202.123/255.255.255.255") or netmask ("10.92.202.61/255.255.255.255"); };
destination d_telcocloud_arc_oll { file("/syslog/telcocloud/arc_oll.log" perm(0655)); };
log { source(net); filter(f_telcocloud_arc_oll); destination(d_telcocloud_arc_oll); };

filter f_telcocloud_cbam_oll        { netmask ("10.92.202.37/255.255.255.255") or netmask ("10.92.202.36/255.255.255.255") ; };
destination d_telcocloud_cbam_oll { file("/syslog/telcocloud/cbam_oll.log" perm(0655)); };
log { source(net); filter(f_telcocloud_cbam_oll); destination(d_telcocloud_cbam_oll); };

filter f_telcocloud_cbam_cor        { netmask ("10.48.37.101/255.255.255.255") or netmask ("10.48.37.100/255.255.255.255") ; };
destination d_telcocloud_cbam_cor { file("/syslog/telcocloud/cbam_cor.log" perm(0655)); };
log { source(net); filter(f_telcocloud_cbam_cor); destination(d_telcocloud_cbam_cor); };

filter f_telcocloud_cbis_oll        { netmask ("10.92.202.4/255.255.255.255"); };
destination d_telcocloud_cbis_oll { file("/syslog/telcocloud/cbis_oll.log" perm(0655)); };
log { source(net); filter(f_telcocloud_cbis_oll); destination(d_telcocloud_cbis_oll); };

filter f_telcocloud_cbis_cor        { netmask ("10.48.37.87/255.255.255.255"); };
destination d_telcocloud_cbis_cor { file("/syslog/telcocloud/cbis_cor.log" perm(0655)); };
log { source(net); filter(f_telcocloud_cbis_oll); destination(d_telcocloud_cbis_cor); };

filter f_telcocloud_under_oll        { netmask ("10.92.202.5/255.255.255.255"); };
destination d_telcocloud_under_oll { file("/syslog/telcocloud/under_oll.log" perm(0655)); };
log { source(net); filter(f_telcocloud_under_oll); destination(d_telcocloud_under_oll); };

filter f_telcocloud_under_cor       { netmask ("10.48.37.85/255.255.255.255"); };
destination d_telcocloud_under_cor { file("/syslog/telcocloud/under_cor.log" perm(0655)); };
log { source(net); filter(f_telcocloud_under_cor); destination(d_telcocloud_under_cor); };

filter f_telcocloud_cbis_ros        { netmask ("10.105.148.20/255.255.255.255"); };
destination d_telcocloud_cbis_ros { file("/syslog/telcocloud/cbis_ros.log" perm(0655)); };
log { source(net); filter(f_telcocloud_cbis_ros); destination(d_telcocloud_cbis_ros); };

filter f_telcocloud_cbam_ros        { netmask ("10.105.148.35/255.255.255.255"); };
destination d_telcocloud_cbam_ros { file("/syslog/telcocloud/cbam_ros.log" perm(0655)); };
log { source(net); filter(f_telcocloud_cbam_ros); destination(d_telcocloud_cbam_ros); };

filter f_telcocloud_under_ros       { netmask ("10.105.148.21/255.255.255.255"); };
destination d_telcocloud_under_cor { file("/syslog/telcocloud/under_cor.log" perm(0655)); };
log { source(net); filter(f_telcocloud_under_cor); destination(d_telcocloud_under_cor); };

filter f_telcocloud_cbis_olleros1        { netmask ("10.92.202.23/255.255.255.255"); };
destination d_telcocloud_cbis_olleros1 { file("/syslog/telcocloud/cbis_olleros1.log" perm(0655)); };
log { source(net); filter(f_telcocloud_cbis_olleros1); destination(d_telcocloud_cbis_olleros1); };

filter f_telcocloud_cbam_olleros1        { netmask ("10.92.202.67/255.255.255.255"); };
destination d_telcocloud_cbam_olleros1 { file("/syslog/telcocloud/cbam_olleros1.log" perm(0655)); };
log { source(net); filter(f_telcocloud_cbam_olleros1); destination(d_telcocloud_cbam_olleros1); };

filter f_telcocloud_under_olleros1       { netmask ("10.92.202.21/255.255.255.255"); };
destination d_telcocloud_under_olleros1 { file("/syslog/telcocloud/under_olleros1.log" perm(0655)); };
log { source(net); filter(f_telcocloud_under_olleros1); destination(d_telcocloud_under_olleros1); };

filter f_telcocloud_ipmi_oll        { netmask ("10.92.202.175/255.255.255.255") or netmask ("10.92.202.199/255.255.255.255") or netmask ("10.92.202.223/255.255.255.255") or netmask ("10.92.202.176/255.255.255.255") or netmask ("10.92.202.200/255.255.255.255"); };
destination d_telcocloud_ipmi_oll { file("/syslog/telcocloud/ipmi_oll.log" perm(0655)); };
log { source(net); filter(f_telcocloud_ipmi_oll); destination(d_telcocloud_ipmi_oll); };

filter f_telcocloud_dammy203_oll        { netmask ("10.92.203.0/255.255.255.0"); };
destination d_telcocloud_dammy203_oll { file("/syslog/telcocloud/dammy203_oll.log" perm(0655)); };
log { source(net); filter(f_telcocloud_dammy203_oll); destination(d_telcocloud_dammy203_oll); };

filter f_telcocloud_dammy_oll        { netmask ("10.92.208.0/255.255.255.0"); };
destination d_telcocloud_dammy_oll { file("/syslog/telcocloud/dammy_oll.log" perm(0655)); };
log { source(net); filter(f_telcocloud_dammy_oll); destination(d_telcocloud_dammy_oll); };

#filter f_telcocloud_wbx_oll        { netmask ("10.92.206.0/255.255.255.0"); };
#destination d_telcocloud_wbx_oll { file("/syslog/telcocloud/wbx_oll.log" perm(0655)); };
#log { source(net); filter(f_telcocloud_wbx_oll); destination(d_telcocloud_wbx_oll); };

filter f_arista_oll        { netmask ("10.92.42.0/255.255.255.0"); };
destination d_arista_oll { file("/syslog/headend/arista_oll.log" perm(0655)); };
log { source(net); filter(f_arista_oll); destination(d_arista_oll); };


filter f_idracs_oll        { netmask ("10.92.43.0/255.255.255.0"); };
destination d_idracs_oll { file("/syslog/headend/idracs_oll.log" perm(0655)); };
log { source(net); filter(f_idracs_oll); destination(d_idracs_oll); };


filter f_oceanstore_tor        { netmask ("10.84.93.150/255.255.255.255"); };
destination d_oceanstore_tor { file("/syslog/log/oceanstore_tor.log" perm(0655)); };
log { source(net); filter(f_oceanstore_tor); destination(d_oceanstore_tor); };








#destination mat_cisco_ios {syslog("10.48.35.44" transport("udp") port(31200) ); };
#log { source(net); filter(f_backbone); destination(mat_cisco_ios);};


#destination mat_mediatrix {syslog("10.48.35.44" transport("udp") port(31203) ); };
#log { source(net); filter(f_iad); destination(mat_mediatrix);  };

#destination matsbc {syslog("10.48.35.44" transport("udp")  port(31205) );  };
#log { source(net); filter(f_sbc); destination(matsbc); };



destination d_fortinet { file("/syslog/log/fortinet.log" perm(0655)); };
filter f_fortinet       { netmask ("192.168.29.0/255.255.255.240"); };
log { source(net); filter(f_fortinet); destination(d_fortinet); flags(final); };

