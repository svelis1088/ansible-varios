[highend@centos8 cve-2021-4034]$ ansible-playbook -i inventario.tux cve-2021-4034.yaml -kKvv
ansible-playbook 2.9.27
  config file = /etc/ansible/ansible.cfg
  configured module search path = ['/home/highend/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/lib/python3.6/site-packages/ansible
  executable location = /usr/bin/ansible-playbook
  python version = 3.6.8 (default, Sep 10 2021, 09:13:53) [GCC 8.5.0 20210514 (Red Hat 8.5.0-3)]
Using /etc/ansible/ansible.cfg as config file
SSH password:
BECOME password[defaults to SSH password]:
Skipping callback 'actionable', as we already have a stdout callback.
Skipping callback 'counter_enabled', as we already have a stdout callback.
Skipping callback 'debug', as we already have a stdout callback.
Skipping callback 'dense', as we already have a stdout callback.
Skipping callback 'dense', as we already have a stdout callback.
Skipping callback 'full_skip', as we already have a stdout callback.
Skipping callback 'json', as we already have a stdout callback.
Skipping callback 'minimal', as we already have a stdout callback.
Skipping callback 'null', as we already have a stdout callback.
Skipping callback 'oneline', as we already have a stdout callback.
Skipping callback 'selective', as we already have a stdout callback.
Skipping callback 'skippy', as we already have a stdout callback.
Skipping callback 'stderr', as we already have a stdout callback.
Skipping callback 'unixy', as we already have a stdout callback.
Skipping callback 'yaml', as we already have a stdout callback.

PLAYBOOK: cve-2021-4034.yaml **************************************************************************
1 plays in cve-2021-4034.yaml

PLAY [Block pkexec with empty first argument with systemtap] ******************************************

TASK [Gathering Facts] ********************************************************************************
task path: /home/highend/Ansible_Projects/cve-2021-4034/cve-2021-4034.yaml:3
[WARNING]: sftp transfer mechanism failed on [rhel78.labotux]. Use ANSIBLE_DEBUG=1 to see detailed
information
ok: [rhel78.labotux]
META: ran handlers

TASK [Install systemtap packages] *********************************************************************
task path: /home/highend/Ansible_Projects/cve-2021-4034/cve-2021-4034.yaml:8
[WARNING]: sftp transfer mechanism failed on [rhel78.labotux]. Use ANSIBLE_DEBUG=1 to see detailed
information
ok: [rhel78.labotux] => {"changed": false, "msg": "", "rc": 0, "results": ["systemtap-4.0-11.el7.x86_64 providing systemtap is already installed", "yum-utils-1.1.31-53.el7.noarch providing yum-utils is already installed", "kernel-devel-3.10.0-1127.el7.x86_64 providing kernel-devel-3.10.0-1127.el7.x86_64 is already installed"]}

TASK [(RHEL 7) Install kernel debuginfo] **************************************************************
task path: /home/highend/Ansible_Projects/cve-2021-4034/cve-2021-4034.yaml:15
[WARNING]: sftp transfer mechanism failed on [rhel78.labotux]. Use ANSIBLE_DEBUG=1 to see detailed
information
changed: [rhel78.labotux] => {"changed": true, "cmd": ["debuginfo-install", "-y", "kernel-3.10.0-1127.el7.x86_64"], "delta": "0:00:00.853511", "end": "2022-02-10 10:21:22.228616", "rc": 0, "start": "2022-02-10 10:21:21.375105", "stderr": "", "stderr_lines": [], "stdout": "Loaded plugins: langpacks, product-id, subscription-manager\n\nThis system is not registered with an entitlement server. You can use subscription-manager to register.\n\nCould not find debuginfo for main pkg: kernel-3.10.0-1127.el7.x86_64\nNo debuginfo packages available to install", "stdout_lines": ["Loaded plugins: langpacks, product-id, subscription-manager", "", "This system is not registered with an entitlement server. You can use subscription-manager to register.", "", "Could not find debuginfo for main pkg: kernel-3.10.0-1127.el7.x86_64", "No debuginfo packages available to install"]}

TASK [(RHEL 6/8) Install polkit debuginfo] ************************************************************
task path: /home/highend/Ansible_Projects/cve-2021-4034/cve-2021-4034.yaml:19
skipping: [rhel78.labotux] => {"changed": false, "skip_reason": "Conditional result was False"}

TASK [(RHEL 6) Install libselinux-python] *************************************************************
task path: /home/highend/Ansible_Projects/cve-2021-4034/cve-2021-4034.yaml:25
skipping: [rhel78.labotux] => {"changed": false, "skip_reason": "Conditional result was False"}

TASK [Create systemtap script] ************************************************************************
task path: /home/highend/Ansible_Projects/cve-2021-4034/cve-2021-4034.yaml:31
[WARNING]: sftp transfer mechanism failed on [rhel78.labotux]. Use ANSIBLE_DEBUG=1 to see detailed
information
changed: [rhel78.labotux] => {"changed": true, "checksum": "19801cb3b58abf8d5d0a0818dc386feacbff077f", "dest": "/root/pkexec-block.stp", "gid": 0, "group": "root", "md5sum": "937b1f7026e7ee9dd3098ecc0242452d", "mode": "0600", "owner": "root", "size": 97, "src": "/home/highend/.ansible/tmp/ansible-tmp-1644499282.2133117-28897-159445052092340/source", "state": "file", "uid": 0}

TASK [Checking if stap_pkexec_block module is already loaded] *****************************************
task path: /home/highend/Ansible_Projects/cve-2021-4034/cve-2021-4034.yaml:44
[WARNING]: sftp transfer mechanism failed on [rhel78.labotux]. Use ANSIBLE_DEBUG=1 to see detailed
information
ok: [rhel78.labotux] => {"changed": false, "cmd": ["grep", "-Fq", "stap_pkexec_block", "/proc/modules"], "delta": "0:00:00.003596", "end": "2022-02-10 10:21:23.816340", "failed_when_result": false, "msg": "non-zero return code", "rc": 1, "start": "2022-02-10 10:21:23.812744", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install systemtap script] ***********************************************************************
task path: /home/highend/Ansible_Projects/cve-2021-4034/cve-2021-4034.yaml:51
[WARNING]: sftp transfer mechanism failed on [rhel78.labotux]. Use ANSIBLE_DEBUG=1 to see detailed
information
changed: [rhel78.labotux] => {"changed": true, "cmd": ["stap", "-F", "-o", "/root/pkexec-block.log", "-S", "1", "-m", "stap_pkexec_block", "-g", "/root/pkexec-block.stp"], "delta": "0:00:16.779082", "end": "2022-02-10 10:21:41.089707", "rc": 0, "start": "2022-02-10 10:21:24.310625", "stderr": "Missing separate debuginfos, use: debuginfo-install kernel-3.10.0-1127.el7.x86_64 ", "stderr_lines": ["Missing separate debuginfos, use: debuginfo-install kernel-3.10.0-1127.el7.x86_64 "], "stdout": "43418", "stdout_lines": ["43418"]}
META: ran handlers
META: ran handlers

PLAY RECAP ********************************************************************************************
rhel78.labotux             : ok=6    changed=3    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0

[highend@centos8 cve-2021-4034]$
